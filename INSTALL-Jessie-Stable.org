#+TITLE: Debian Stable (Jessie) install
#+AUTHOR: Mathieu Basille

This is a complete tutorial to install Debian Stable (Jessie). See
also the official [[https://www.debian.org/releases/stable/amd64/][Debian installation guide]]. Most of the instructions
are general enough to be applied on any computer. Keep in mind,
however, that:
- Hardware configuration (including keyboard layout) is tuned for a
  laptop *DELL Latitude E6320*;
- The system is in French, with AZERTY keyboard layout.


* Table of contents                                                     :TOC_3:
 - [[#installing-debian-with-the-base-gnome-desktop][Installing Debian with the base Gnome desktop]]
   - [[#download-the-installer][Download the installer]]
     - [[#the-debian-way][The Debian way]]
     - [[#the-easy-way][The easy way]]
   - [[#install-debian][Install Debian]]
   - [[#terminal-setup][Terminal setup]]
   - [[#system-settings][System settings]]
   - [[#apt-and-upgrade][APT and upgrade]]
 - [[#installing-a-full-system][Installing a full system]]
   - [[#miscellaneous][Miscellaneous]]
   - [[#gnome-extensions][Gnome extensions]]
   - [[#web][Web]]
     - [[#firefox][Firefox]]
     - [[#thunderbird-icedove][Thunderbird (Icedove).]]
     - [[#owncloud][ownCloud]]
     - [[#others][Others]]
   - [[#internet-admin][Internet admin]]
     - [[#vpn][VPN]]
     - [[#ssh][SSH]]
     - [[#gftp][Gftp]]
     - [[#owncloud-and-dropbox][ownCloud and Dropbox]]
     - [[#windows-share][Windows share]]
     - [[#revelation][Revelation]]
   - [[#multimedia][Multimedia]]
   - [[#office][Office]]
     - [[#fonts][Fonts]]
     - [[#latex-and-pdf][LaTeX and PDF]]
     - [[#emacs][Emacs]]
     - [[#jabref-configuration][JabRef configuration]]
     - [[#gnote-configuration][Gnote configuration]]
   - [[#r-qgis-and-postgis][R, QGIS and PostGIS]]
     - [[#gdal-geos-and-proj4][GDAL, GEOS and PROJ.4]]
     - [[#r][R]]
     - [[#qgis-and-postgis][QGIS and PostGIS]]
   - [[#other][Other]]
     - [[#google-stuff][Google Stuff]]
     - [[#skype][Skype]]
     - [[#rockbox-utility][Rockbox utility]]
   - [[#final-stage][Final stage]]
   - [[#software][Software]]
     - [[#general][General]]
     - [[#web-1][Web]]
     - [[#multimedia-1][Multimedia]]
     - [[#polices][Polices]]
     - [[#emacs--latex--pdf][Emacs / LaTeX / PDF]]
     - [[#other-1][Other]]

* Installing Debian with the base Gnome desktop


** Download the installer


*** The Debian way

Start by downloading an image of
[[https://www.debian.org/distrib/ftplist][Debian] for Debian Stable
(Jessie), according to the platform of the computer. A good choice is
the Network install (=netinst=), which will fetch all system packages
directly on-line when installing. In this case, download is the ISO
image for USB sticks for amd64
(=debian-8.7.1-amd64-netinst.iso=). Then check [[http://cdimage.debian.org/debian-cd/current/amd64/iso-cd/MD5SUMS][MD5 sums]] to guarantee
the integrity of the file:

#+BEGIN_SRC sh
  md5sum debian-8.7.1-amd64-netinst.iso
#+END_SRC
#+RESULTS:
  : 453312bf56fc45669fec5ebc0f025ac7  debian-8.7.1-amd64-netinst.iso

The next step is to copy the ISO on a USB flash drive. First check
on which device the flash drive is mounted:

#+BEGIN_SRC sh
  df -h
#+END_SRC
#+RESULTS:
  : Filesystem      Size  Used Avail Use% Mounted on
  : /dev/sda1        28G   15G   12G  55% /
  : ...
  : /dev/sda3       204G  195G  2.8G  99% /home
  : tmpfs           789M   40K  789M   1% /run/user/1000
  : /dev/sdb1       7.5G  184K  7.5G   1% /media/<user>/<FLASH>

In this case, this shows that the flash drive is associated to
=sdb1=. Note that we need to write to the whole disk, so we will be
using =sdb=, not the partition =sdb1=.  (WARNING #1: This formats the
entire stick! WARNING #2: Change the value of =sdb= accordingly!
WARNING #3: The =sync= command can take quite a while):

#+BEGIN_SRC sh
  sudo dd if=debian-8.7.1-amd64-netinst.iso of=/dev/sdb1
  sudo sync
#+END_SRC

Now unmount the flash drive, and from now on, all other steps will be
on the 'target' computer.

  : sudo umount /dev/sdb1 


*** The easy way

*NOTE:* For a reason, the standard procedure above failed for me this
time, with the system being unable to boot on the flash drive… A
workaround is simply to use =Unetbootin= GUI to create the USB
bootable image (using the Netinstall 64 bits for Debian Stable), check
that the =boot= flag is set on the drive (with GParted), and move
directly to the next step.


** Install Debian

You can now boot the computer on the USB flash drive (on a modern DELL
laptop, that requires to turn off UEFI Security Boot, in favor of
Legacy boot) and follow the instructions. General guidelines:

- *Root:* Leave the password empty — that way, root permissions are
  given to the first user using =sudo=.
- *Partitions:* Use *Guided - use entire disk*, with only one
  partition for everything. The partitioner will allocate 10 GB for
  the swap (a little bit more than the RAM amount). Two good
  modifications are to keep only 3 % of reserved blocks for root
  (maintenance).
- It's a good idea to participate in the package usage survey (results
  are encrypted).
- Chose GNOME for the desktop, and leave =print server= and =standard
  system utilities=.
- Finally, install the GRUB boot loader to the master boot record on
  the first hard drive (pick the hard drive, not the USB flash
  drive!).
- Time to restart!


** Terminal setup

- In the preferences, remove menu, and use a dark theme; in the
  Profile preferences, remove the terminal Beep.
- Bash configuration:
  : sudo nano /etc/bash.bashrc
  - *Autocompletion:* uncomment the following lines:
  #+BEGIN_QUOTE
  : if ! shopt -oq posix; then
  :   if [ -f /usr/share/bash-completion/bash_completion ]; then
  :     . /usr/share/bash-completion/bash_completion
  :   elif [ -f /etc/bash_completion ]; then
  :     . /etc/bash_completion
  :   fi
  : fi
  #+END_QUOTE
  - *Other:* add the following at the end of the file:
  #+BEGIN_QUOTE
  : # Ctrl-N keeps current directory
  : export PS1='\[$(__vte_ps1)\]'$PS1
  : 
  : # Manpages with colors
  : export MANPAGER="/usr/bin/most -s"
  : 
  : # Alias upgrade & upgrade-full
  : alias upgrade='sudo apt update && sudo apt upgrade'
  : alias upgrade-full='sudo apt update && sudo apt full-upgrade && sudo apt-get clean && sudo apt-get autoclean && sudo apt-get autoremove'
  #+END_QUOTE


** System settings

- [[https://wiki.debian.org/SSDOptimization][Optimize SSD]]:
  - [[http://doc.ubuntu-fr.org/ssd_solid_state_drive#diminuer_la_frequence_d_ecriture_des_partitions][Reduce write frequency]] + boost performance:
    : sudo nano /etc/fstab
    Add the =noatime= and =discard= options for every SSD partition.
  - =/tmp= in RAM:
    : sudo nano /etc/fstab
    #+BEGIN_QUOTE
    # /tmp dans la RAM
    tmpfs      /tmp            tmpfs        defaults,size=1g
    #+END_QUOTE
  - Init settings:
    : sudo update-initramfs -u -k all
  - Remove =.xsession-errors=
    : echo 'ln -fs /dev/null "$HOME"/.xsession-errors' | sudo tee /etc/X11/Xsession.d/00disable-xsession-errors
- Use only SWAP when 99% of RAM is used:
  : sudo nano /etc/sysctl.conf
  Add at the end of the file:
  #+BEGIN_QUOTE
  : # SWAP after 99% RAM used 
  : vm.swappiness = 1
  #+END_QUOTE
- Date in the top bar with time:
  : gsettings set org.gnome.desktop.interface clock-show-date true
- Keep numpad activated between sessions:
  : gsettings set org.gnome.settings-daemon.peripherals.keyboard remember-numlock-state true
- Disable the sleep button (mapped to Fn+Insert) [doesn't work?]:
  : gsettings set org.gnome.settings-daemon.plugins.power power-button-action "nothing"
- System settings
  - Remove the system beep: in Sound > Sound Effects, turn off the
    Alert volume.
  - Touchpad: in Mouse & Touchpad, activate "Tap to Click" and
    "Two-finger Scrolling".
  - Keyboard shortcuts:
    - Home folder: Super+H
    - Hide all normal windows: Super+D
    - Lock screen: Ctrl+Echap
    - Toggle maximization state: Super+Return
    - Add Custom shortcut: Terminal / =gnome-terminal= / Super+T
- Nautilus: Preferences > Views: Sort folders before files


** APT and upgrade

- Copy =sources.list= and =preferences= in =/etc/apt/=.
  : sudo cp etc/apt/sources.list.jessie-stable /etc/apt/sources.list
- Avoid downloading translation indexes:
  : sudo nano /etc/apt/apt.conf.d/apt.conf
  #+BEGIN_QUOTE
  : Acquire::Languages "none";
  #+END_QUOTE
- Enable the installation of i386 packages:
  : sudo dpkg --add-architecture i386
- Complete upgrade + install:
  : sudo apt update
  : sudo apt install deb-multimedia-keyring pkg-mozilla-archive-keyring most
  : sudo apt upgrade
  : sudo apt full-upgrade
  : upgrade-full
- [[http://wiki.debian.org/fr/iwlwifi][WIFI Firmware support]]:
  : sudo apt install firmware-iwlwifi
  : sudo modprobe -r iwlwifi
  : sudo modprobe iwlwifi


* Installing a full system


** Miscellaneous

  : sudo apt install autoconf build-essential cmake cmake-curses-gui debian-goodies detox disper git gnome-common gparted gtick hibernate mlocate ntp privoxy subversion transmission units unrar virtualbox wakeonlan


** Gnome extensions

To be able to install Gnome extensions from Firefox ≥v.52, a Debian
package and a [[https://addons.mozilla.org/en-US/firefox/addon/gnome-shell-integration/][Firefox extension]] are required:

  : sudo apt install chrome-gnome-shell gnome-shell-extension-redshift

[[https://extensions.gnome.org/local/][List of extensions]] (o Installed; x Installed but not activated):

- x Alt-Alt+Tab (outdated)
- x AlternateTab
- x Applications Menu
- o Auto Move Windows
- o BackSlide
- o Disconnect Wifi
- x Gnote/Tomboy Integration (outdated)
- x gTile (outdated)
- o Hibernate Status Button
- x Launch new instance
- o Media player indicator (reinstall from source after media install)
  Outdated on official GNOME respository, but available on [[https://github.com/eonpatapon/gnome-shell-extensions-mediaplayer][GitHub]]: 
  : git clone https://github.com/eonpatapon/gnome-shell-extensions-mediaplayer.git
  : cd gnome-shell-extensions-mediaplayer/
  : ./autogen.sh
  : make install-zip
  Then restart GNOME Shell (Alt-F2 + r)
- x Modern Calc (outdated)
- x Native Window Placement
- o Nothing to say
  Change shortcut to Super+F1:
 : dconf write /org/gnome/shell/extensions/nothing-to-say/keybinding-toggle-mute '["<Super>F1"]'
- o OpenWeather
- x Places Status Indicator
- o Refresh Wifi Connections
- x Removable Drive Menu
- o Remove Dropdown Arrows
- x Return to Monitor (outdated)
- x Screenshot Window Sizer
- o SincroDirs
- o Skype Integration
- o Sound Input & Output Device Chooser
- o Super+Tab Launcher
- o Suspend Button
- o TopIcons Plus
- x User Themes
- x Window List
- o windowNavigator
- x Workspace Indicator
- x workspaceAltTab (outdated)


** Web

  : sudo apt install firefox icedove iceowl-extension enigmail privoxy torbrowser-launcher chromium epiphany-browser mozplugger pipelight-multi

*** Firefox

To get a "clean" Firefox profile: Simply connect to Sync with your
Firefox account to synchronize Tabs, Bookmarks, Passwords, History,
Add-ons and Preferences from old Firefox. Leave Firefox open for some
time... After all add-ons are installed, a little bit of tweaking is
necessary after:
- Enable GNOME theme (in Appearance). 
- *Add-ons:* Some add-ons were not synced and installed: HTTPS
  Everywhere, Privacy Badger; some options need to be reset
  (e.g. notifications for Self-Destructing Cookies).
- *Plugins:* Need to activate OpenH264 Video Codec provided by Cisco.
- *Open tabs:* Open tabs (including permanent tabs) are not synced:
  Close both old and new Firefox. Check the =sessionstore.js= file
  created in old Firefox's profile when Firefox closes. Copy it in the
  new profile.
- *Search engines:* Copy the =search.json.mozlz4= file from old to new
  profile.
- Add-on *data* is not synced: Copy necessary folders in tne new profile
  (e.g. Scrapbook).
- Restart new Firefox and customize interface (buttons in the top bar
  and menu).

Here is the full list of add-ons that I normally install:
- Essential security and privacy:
  - [[https://addons.mozilla.org/fr/firefox/addon/betterprivacy/][Better Privacy]] (if Flash installed)
  - [[https://addons.mozilla.org/fr/firefox/addon/https-everywhere/][HTTPS Everywhere]]
  - [[https://addons.mozilla.org/fr/firefox/addon/privacy-badger-firefox/][Privacy Badger]]
  - [[https://addons.mozilla.org/fr/firefox/addon/self-destructing-cookies/][Self-Destructing Cookies]]
  - [[https://addons.mozilla.org/fr/firefox/addon/ublock-origin/][uBlock Origin]]
- Essential functionalities:
  - [[https://addons.mozilla.org/fr/firefox/addon/findbar-tweak/][FindBar Tweak]]
  - [[https://addons.mozilla.org/fr/firefox/addon/tab-groups-panorama/][Tab Groups]]
  - [[https://addons.mozilla.org/fr/firefox/addon/lazarus-form-recovery/][Lazarus: Form Recovery]]
  - [[https://addons.mozilla.org/fr/firefox/addon/scrapbook/][ScrapBook]]
- Appearance and integration with GNOME 3:
  - [[https://addons.mozilla.org/fr/firefox/addon/gnome-theme-tweak/][GNOME Theme Tweak]]
  - [[https://addons.mozilla.org/fr/firefox/addon/gnotifier/][GNotifier]]
  - [[https://addons.mozilla.org/fr/firefox/addon/htitle/][HTitle]] (discontinued!)
  - [[https://addons.mozilla.org/en-US/firefox/addon/gnome-shell-integration/][GNOME Shell integration]]
- Videos and streaming:
  - [[https://addons.mozilla.org/fr/firefox/addon/download-youtube/][Download YouTube Videos as MP4]]
  - [[https://addons.mozilla.org/fr/firefox/addon/user-agent-switcher/][User-Agent Switcher]] (useful for Netflix for instance)
  - [[https://addons.mozilla.org/fr/firefox/addon/video-downloadhelper/][Video DownloadHelper]]
  - [[https://addons.mozilla.org/fr/firefox/addon/youtube-all-html5/?src=search][YouTube ALL HTML5]]
- Others:
  - [[https://addons.mozilla.org/fr/firefox/addon/checkcompatibility/][checkCompatibility]] (because some add-ons don't keep up with new
    Firefox versions)
  - [[https://addons.mozilla.org/fr/firefox/addon/clean-links/][Clean Links]]
  - [[https://addons.mozilla.org/fr/firefox/addon/flagfox/][Flagfox]]
  - [[https://addons.mozilla.org/fr/firefox/addon/nuke-anything-enhanced/][Nuke Anything Enhanced]]
  - [[https://addons.mozilla.org/fr/firefox/addon/qwantcom-for-firefox/][Qwant for Firefox]]
  - [[https://addons.mozilla.org/fr/firefox/addon/shaarli/][Shaarli]]
  - [[https://addons.mozilla.org/en-US/firefox/addon/smart-referer/][Smart Referer]]

And the list of search engines that I keep:
- Google [by default]
- [[https://addons.mozilla.org/fr/firefox/addon/google-fr-recherche-sur-le-web/][Google.fr (Web)]] [installed]
- Wikipedia (en)
- [[https://addons.mozilla.org/fr/firefox/addon/wikipedia-fr/][Wikipedia (fr)]] [installed]
- [[https://addons.mozilla.org/fr/firefox/addon/qwant/][Qwant]] [installed]
- Debian packages

The next step is to install additional plugins. Unfortunately, Flash
may still be necessary for some websites, and Silverlight is necessary
for NetFlix. The *[[http://pipelight.net/cms/installation.html][Pipelight]]* project conveniently provides Windows-only
plugins directly inside the browsers. First update the pipelight
plugin:
  : sudo pipelight-plugin --update
Just to be safe, close Firefox, then enable Flash and Silverlight:
  : sudo pipelight-plugin --enable flash
  : sudo pipelight-plugin --enable silverlight
  : sudo pipelight-plugin --create-mozilla-plugins
  : sudo pipelight-plugin --list-enabled
After restarting Firefox, plugins can be check in the Plugins section
of the Add-ons panel (then select "Ask to activate" for both). Flash
in particular can be checked at: http://isflashinstalled.com/

If BetterPrivacy is installed too, use =~/.wine-pipelight= as the
Flash-Data directory.

*Update January 2017:* Pipelight is not maintained anymore. The good
news is that now Adobe ships the latest Flash version for Linux too!
Disable Flash from Pipelight (if it was installed/enabled), and simply
install the =flashplugin-nonfree= from Debian repositories, or
=flashplayer-mozilla= and =flashplayer-chromium= from Debian
Multimedia repositories (the later allowing for Flash updates through
general system update):

  : pipelight-plugin --disable flash
  : pipelight-plugin --list-enabled
  : sudo apt install flashplayer-mozilla flashplayer-chromium


*** Thunderbird (Icedove).

- From a previous installation, simply copy the content of the former
  profile into the default profile folder in =~/.icedove=.

- Enigmail (needs version >= 2.07):
  Then change Gnome settings for the passphrase:
  : gsettings list-recursively org.gnome.crypto.cache
  Lists relevant settings: the method can be 'session' (never expires
  during the session), 'idle' (timer is reset each time there's
  activity on the computer) or 'timeout' (simple timer since entering
  the passphrase). We set it to 'idle' with 5 minutes of delay:
  : gsettings set org.gnome.crypto.cache gpg-cache-method "timeout"
  : gsettings set org.gnome.crypto.cache gpg-cache-ttl 300
  If it comes from a former installation, copy the =.gnupg/= folder in
  =~/=, and ensure permissions are correct:
  : chmod -R go-rwx ~/.gnupg
  Check that GnuPG is installed with a version >2:
  : gpg --version
  And finally migrate from old version:
  : gpg -K
  Note that there is a bug with Enigmail 1.9.6-1 (which doesn't
  recognize gpg); [[https://www.mail-archive.com/debian-bugs-dist@lists.debian.org/msg1471698.html][fixed in 1.9.6-2]]:


*** ownCloud

In Settings > Online accounts, add a new ownCloud account. Simply fill
in the server address (where ownCloud is installed, not one of the
scripts for CalDav/CardDav), username and password, and keep it for
Calendar, Contacts, Documents and Files. Now events should appear in
the calendar in the top bar, contacts should be synchronized with the
Contacts application, and Files (Nautilus) should provide a shortcut
to the ownCloud root folder.


*** Others

# - Privoxy:
#  Settings > Network > Network proxy : HTTP/HTTPS = localhost:8118


** Internet admin

  : sudo apt install cifs-utils gftp gvncviewer network-manager-openconnect-gnome network-manager-vpnc-gnome revelation rsync screen unison


*** VPN

In Settings > Network, add a 'Cisco AnyConnect Compatible VPN
(openconnect)'. Simply enter the 'Gateway': =vpn.ufl.edu= and leave all
other empty. To turn the VPN on, click VPN in the top-right corner
menu:
- Username: GatorLink account (with @ufl.edu)
- Password: GatorLink password (check 'Save passwords')


*** SSH

Copy the entire folder =.ssh= in =/home=. It contains key configuration
for basille.net, Gargantua, MabLab server, as well as the keys for
GitHub.


*** Gftp

Simply copy the =bookmarks= file from the =.gftp= folder in =/home/= (it
contains all bookmarks and passwords).


*** ownCloud and Dropbox

  : sudo aptitude install owncloud-client nautilus-owncloud nautilus-dropbox

For ownCloud, configure the client: run =owncloud=, fill in the proper
credentials, and choose what to sync and where (=.owncloud= is a good
choice if it concerns only files for sync, and not documents per se).

For DropBox, install the proprietary deamon:

  : dropbox start -i

And follow the instructions (UF has a single sign-in process that
works by just adding the UF address without password, with a passcode
generated on the web).


*** Windows share

First create a credential file:
  : nano .smb
With the following information:
  #+BEGIN_QUOTE
  : username=<GatorLink account>
  : password=<GatorLink password>
  #+END_QUOTE
And reduce permissions on it:
  : chmod 600 .smb

# sudo mkdir /mnt/ecored
# sudo mount.cifs //if-srv-flfile02/data/Unit/EcoRed /mnt/ecored/ -o credentials=/home/#mathieu/.smb,uid=mathieu,gid=mathieu

# mkdir MabLab
# mkdir MabLab/bkp
# mkdir MabLab/bkp/mathieu
# mkdir MabLab/bkp/mathieu/home


*** Revelation

- Create a new password file in =~/.revelation= or copy an existing one
  in this folder.
- Change preferences:
  * "Open file on startup:" and pick the file mentioned above;
  * Check "Automatically save data when changed"
  * "Length of generated passwords": 12


** Multimedia

- Pictures
  : sudo aptitude install gimp-gmic gimp-plugin-registry gimp-resynthesizer gthumb hugin imagemagick darktable rawtherapee phatch qtpfsgui 

- Audio/video
  : sudo apt install audacity cuetools easytag flac gstreamer1.0-ffmpeg gstreamer1.0-fluendo-mp3 gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly monkeys-audio shntool soundconverter devede mkvtoolnix oggconvert pitivi frei0r-plugins gnome-video-effects-frei0r openshot rhythmbox-plugins rhythmbox-plugin-alternative-toolbar sound-juicer sox subtitleeditor vlc vorbis-tools vorbisgain qarte

  - Plugins Rhythmbox: A [[https://launchpad.net/~fossfreedom/+archive/rhythmbox-plugins][repository for Ubuntu]] provides updated
    plugins for Rhythmbox. Instructions can be found [[http://xpressubuntu.wordpress.com/2013/10/26/installing-rhythmbox-3-0-plugins-the-easy-way/][here]], and =deb=
    files can be found [[https://launchpad.net/~fossfreedom/+archive/rhythmbox-plugins/+packages][here]]. In summary, download the file
    corresponding to the most recent version of Ubuntu (Xenial at the
    time of writing), and install them using =dpkg=. If all =deb= files are in
    a dedicated folder:

    : sudo dpkg -i *.deb
    
    And if necessary:

    : sudo apt -f install 

    Currently, the following packages work:
    - Art Display
    - Equalizer (not up-to-date but works)
    - Fullscreen Plugin
    - lLyrics
    - Open containing folder
    - Playlist Import Export
    - Random Album Player
    - Remember-the-Rhythm

    One very interesting package is not up to date and does not work:
    - lastfm-queue

    Finally, =rhythmbox-plugins= also provides Cover Art/Search,
    Internet Radios, Replay Gain and other potentially interesting
    plugins, and =rhythmbox-plugin-alternative-toolbar= gives a
    simplified and enhanced user interface.

- Leisure
  : sudo apt install chromium-bsu dosbox marble stellarium sweethome3d

# Slowmo : http://slowmovideo.granjow.net/
# Récupérer package for Ubuntu Raring
# Dépendances :
# $ sudo aptitude install build-essential cmake git ffmpeg libavformat-dev libavcodec-dev libswscale-dev libqt4-dev freeglut3-dev libglew1.5-dev libsdl1.2-dev libjpeg-dev libopencv-video-dev libopencv-highgui-dev
# (attention, conflit entre libopencv-highgui-dev qui demande libtiff4 alors que libtiff5 est installée...)
# Puis
# $ sudo dpkg -i slowmovideo_0.3.1-5~raring1_amd64.deb

# Fichiers RAW

# ## DCRAW 9.16 (version courante)
# sudo aptitude install libjasper-dev libjpeg8-dev liblcms1-dev liblcms2-dev
# sudo ldconfig
# mkdir dcraw
# cd dcraw
# wget http://www.cybercom.net/~dcoffin/dcraw/dcraw.c
# gcc -o dcraw -O4 dcraw.c -lm -ljasper -ljpeg -llcms
# sudo mv dcraw /usr/bin
# cd ..
# rm -R dcraw

# ## Vignettes
# sudo aptitude install ufraw ufraw-batch gimp-dcraw
# sudo nano /usr/share/thumbnailers/raw.thumbnailer
# Plus nécessaire :
# $ sudo aptitude install libopenrawgnome1

# [Thumbnailer Entry]
# Exec=/usr/bin/ufraw-batch --embedded-image --out-type=png --size=%s %u --overwrite --silent --output=%o
# MimeType=image/x-3fr;image/x-adobe-dng;image/x-arw;image/x-bay;image/x-canon-cr2;image/x-canon-crw;image/x-cap;image/x-cr2;image/x-crw;image/x-dcr;image/x-dcraw;image/x-dcs;image/x-dng;image/x-drf;image/x-eip;image/x-erf;image/x-fff;image/x-fuji-raf;image/x-iiq;image/x-k25;image/x-kdc;image/x-mef;image/x-minolta-mrw;image/x-mos;image/x-mrw;image/x-nef;image/x-nikon-nef;image/x-nrw;image/x-olympus-orf;image/x-orf;image/x-panasonic-raw;image /x-pef;image/x-pentax-pef;image/x-ptx;image/x-pxn;image/x-r3d;image/x-raf;image/x-raw;image/x-rw2;image/x-rwl;image/x-rwz;image/x-sigma-x3f;image/x-sony-arw;image/x-sony-sr2;image/x-sony-srf;image/x-sr2;image/x-srf;image/x-x3f;


** Office

  : sudo apt install abiword aspell aspell-fr aspell-en gnote homebank hunspell hunspell-en-ca hunspell-en-us hunspell-fr inkscape jabref libreoffice-gnome libreoffice-gtk libreoffice-pdfimport libreoffice-style-breeze libreoffice-style-oxygen libreoffice-style-sifr myspell-en-gb pandoc pandoc-citeproc tesseract-ocr tesseract-ocr-eng tesseract-ocr-fra

- Need to remove all links to French dictionaries:
  : sudo rm /usr/share/hunspell/fr_*
  : sudo rm /usr/share/myspell/dicts/fr_*
  In case of trouble, just reinstal =hunspell-fr=.
- Change Icon style of LibreOffice (Tools > Options > LibreOffice >
  View) to Breeze, and possibly Show Icons in menus.
- Preferences for HomeBank are stored in =~/.config/homebank=. It's
  probably safe to simply copy this folder.


*** Fonts

  : sudo apt install fonts-arphic-ukai fonts-arphic-uming fonts-arphic-gkai00mp fonts-arphic-gbsn00lp fonts-arphic-bkai00mp fonts-arphic-bsmi00lp fonts-crosextra-carlito fonts-crosextra-caladea fonts-hack-ttf ttf-mscorefonts-installer ttf-kochi-gothic ttf-kochi-mincho ttf-baekmuk unifont

- Use =gnome-tweak-tool= to change Monospace font to Hack Regular 11.
- [[https://wiki.debian.org/SubstitutingCalibriAndCambriaFonts][Alternatives for Calibri/Cambria]] (MS fonts) : Carlito and
  Caladea. Once installed, in LibreOffice: Options > Fonts, check
  'Apply replacement table', and add a replacement rule for each
  (Calibri -> Carlito, Cambria -> Caladea). Leave everything unchecked
  (Always and screen only).


*** LaTeX and PDF

  : sudo aptitude install gedit-latex-plugin gummi ispell texlive-full bibtex2html rubber latex2rtf xpdf pdftk pdfjam poppler-utils libtext-pdf-perl pdf2svg impressive pdfchain pdfshuffler calibre mupdf pdf2djvu scribus xournal ditaa

Note that =biblatex= lives in =texlive-bibtex-extra=, which comes with
=texlive-full=; =pdfmanipulate= comes with =calibre=.

- Adobe Reader (in dmo)
  : sudo aptitude install acroread:i386

- Link folder of main BibTeX file to the Tex install. First check
  with:
  : kpsewhich -show-path=.bib
  It should include
  =/home/<user>/.texlive2016/texmf-var/bibtex/bib//=. The trick is
  then to create this path as a link to the main bibliographic
  directory. For instance:
  : mkdir -p ~/.texlive2016/texmf-var/bibtex/bib
  : ln -s ~/Work/Biblio/ ~/.texlive2016/texmf-var/bibtex/bib
- Install a package (e.g. =moderncv=)
  : sudo nano /etc/texmf/texmf.d/03local.cnf
  #+BEGIN_QUOTE
  : TEXMFHOME = ~/.texlive2016/texmf
  #+END_QUOTE
  : sudo update-texmf
  Check with:
  : kpsewhich --var-value TEXMFHOME
  Copy packages in =~/.texlive2016/texmf/tex/latex/= and complete
  install when necessary, e.g.:
  : latex moderntimeline.ins
  : latex moderntimeline.dtx
- Install a font: copy the font in
  =~/.texlive2016.d/texmf/fonts/truetype/=, then update the TeX index:
  : sudo texhash


*** Emacs

  : sudo aptitude install emacs25 libpoppler-glib-dev

[[https://github.com/basille/.emacs.d][Configuration via Git]]:
  : git clone git@github.com:basille/.emacs.d ~/.emacs.d/
  : cp ~/.emacs.d/emacs.Xresources ~/.Xresources
  : xrdb -merge ~/.Xresources

And load Emacs, potentially several times until all packages are
installed.


*** JabRef configuration

Debian recently integrated the 3.x series in the official
repositories, with JabRef 3.6 available for Stretch and 3.8 for Sid at
the time of writing (Dec 22 2016).

In Options > Preferences:
- Import preferences (=JabRef-Pref-20161206.xml=). Should be enough, but
  just in case, check the following.
- Keep English as language.
- External programs: Use =/home/mathieu/Work/biblio/PDF/= as main file
  folder.
- Advanced > Class name: "com.sun.java.swing.plaf.gtk.GTKLookAndFeel"
  for GTK look & feel.

Finally, install Zotero and JabFox add-ons for Firefox, and then
adjust JabFox and JabRef preferences:
- Create a script to correctly catch the call:
  : echo -e '#!/bin/bash\njava -jar /usr/share/java/jabref.jar "$@"' | sudo tee /usr/share/java/jabref.sh
  : sudo chmod +x /usr/share/java/jabref.sh
- JabFox: Adjust the path to the JabRef script above
  ('extensions.@jabfox.jabRefPath' preference of Firefox);
- JabFox: Export format to BibTeX;
- JabRef: Activate "Remote operation" under the Advanced tab.


*** Gnote configuration

- +Synchronization using WebDav seems really complicated to set up; one solution is to use ownCloud client to sync a =Gnote= folder localy, and then configure it in Gnote Preferences > Synchronization using Local folder as a service (and check the Automatic sync every 10
  minutes).+
  - Synchronization seems to cause many crashes of Gnote… Hence simply
    copying the note folder (=~/.local/share/gnote=) should be enough.
- Other preferences:
  - General: Always open notes in new window
  - Plugins: Enable 'Export to HTML' and 'Table of contents'.
- Using =gnome-tweak-tool=, add Gnote to the list of Startup
  Applications.


** R, QGIS and PostGIS


*** GDAL, GEOS and PROJ.4

  : sudo apt install gdal-bin libgdal-dev libgeos-dev proj-bin libproj-dev


*** R

  : sudo apt install r-base-core r-base-dev r-recommended r-cran-rodbc r-cran-rjava r-cran-tkrplot littler jags libcairo2-dev libglu1-mesa-dev libssl-dev libxt-dev libudunits2-dev

[[https://github.com/basille/R][Configuration via Git]]:
  : git clone git@github.com:basille/R ~/.R-site/
  : mkdir ~/.R-site/site-library
  : ln -s ~/.R-site/.Renviron ~/.Renviron

Then in R:
  : gdal <- TRUE; options(repos = c(CRAN = "http://cran.r-project.org/")); source("~/.R-site/install.selected.R")

And finally link to the R profile:
  : ln -s ~/.R-site/.Rprofile ~/.Rprofile

RStudio is unfortunately not in the Debian repositories (yet). So the
recommanded way to install it is to download the latest installer,
which is, on Dec 2 2016, for version 1.0.44 (check [[https://www.rstudio.com/products/rstudio/download/][here]] first):

  : wget https://download1.rstudio.org/rstudio-1.0.44-amd64.deb
  : sudo dpkg -i rstudio-1.0.44-amd64.deb 
  : rm rstudio-1.0.44-amd64.deb 

(RStudio has a tendancy to mess a bit with file associations, so it
might be necessary to clean that after if RStudio is not supposed to
be the default R editor; as a matter of fact, if it is the case, it is
the easiest way to associate =.R= or =.Rmd= files to any editor, while
keeping the association to Gedit for plain text documents)

RStudio is provided with its own version of Pandoc, but it seems to
come [[https://github.com/rstudio/rmarkdown/issues/867][with potential problems]]. The easiest way to overcome this is
simply to rename the Pandoc executable provided by RStudio (requests
will then fallback on the system Pandoc):

  : sudo mv /usr/lib/rstudio/bin/pandoc/pandoc /usr/lib/rstudio/bin/pandoc/pandoc.bkp

Note that RStudio is not adapted to very high resolution (for instance
Retina) and may look very tiny in this case.


*** QGIS and PostGIS

  : sudo apt install qgis python-qgis

Or if it fails due to a missing package (gdal-abi-2), then prefer the
install from Debian repositories:

  : sudo apt install -t o=Debian,n=stretch qgis python-qgis

Then, from inside QGIS, install the Time manager plugin.


** Other


*** Google Stuff


**** Google Earth

The Debian way:
  : sudo apt install googleearth-package
  : make-googleearth-package
  : sudo dpkg -i googleearth*.deb
  : sudo apt -f install

But dependencies impossible to reconcile (libcurl3:i386)... Solution:
get official .deb from [[https://www.google.com/earth/download/ge/agree.html][Google]], then:
  : sudo dpkg -i google-earth-stable_current_amd64.deb
  : sudo apt -f install


**** Google Chrome

Add Google Chrome repository (sources.list + preferences), then:
  : sudo apt install google-chrome-stable


*** Skype

At last, Microsoft now provides a decent version of Skype for Linux
(based on their new web version), currently in its alpha stage. The
application seems to work fine, and can be concurrently installed with
the 'legacy' version (it's called "Skype for Linux" and the binary is
=skypeforlinux=):

  : wget https://repo.skype.com/latest/skypeforlinux-64-alpha.deb
  : sudo dpkg -i skypeforlinux-64-alpha.deb 
  : sudo apt -f install
  : rm skypeforlinux-64-alpha.deb 

Note that alternatives exist, such as [[https://github.com/stanfieldr/ghetto-skype][Ghetto Skype]] (which does not
currently provide video calls).


*** Rockbox utility

- Download [[http://www.rockbox.org/download/][Rockbox utility]]
- Unzip file, and copy RockboxUtility in =/usr/local/bin/=:
  : tar xvjf RockboxUtility-v1.4.0-64bit.tar.bz2
  : sudo mv RockboxUtility-v1.4.0-64bit/RockboxUtility /usr/local/bin/rockbox
  : sudo chmod 755 /usr/local/bin/rockbox 
  : rm -R RockboxUtility-v1.4.0-64bit
- Launch =rockbox=
- Install Ambiance theme (activate icons).


** Final stage

- Check default applications (Settings > Details > Default
  Applications).
- Check applications on startup with =gnome-tweak-tool= (Startup
  Applications: icedove, firefox, nautilus, gnote).
- Final cleaning:
  : upgrade-full


** Software

*** General


- Install =sudo= (if necessary):
  : # adduser mathieu sudo
  - Then relog:
  : # su - mathieu
  - Deactivate root account:
  : sudo passwd -l root
  - To re-activate root account (if necessary):
  : sudo passwd -u root
# • Enlever le bip système :
# ∘ https://wiki.archlinux.org/index.php/Disable_PC_Speaker_Beep
# ∘ Ce qui a marché pour moi (Gnome 3.8) :
# xset -b
# ‣ Mettre dans les applications au démarrage :
# $ gnome-session-properties
# Beep system OFF
# xset -b
# ∘ Gnome 3.12 : Paramètres > Son > Effets sonores > Volume 0

  or =$ sudo aptitude install gnome-desktop-environment=
  : sudo aptitude install gnome
  : sudo tasksel install desktop
  : sudo tasksel install laptop
  : sudo aptitude install laptop-mode-tools
  : sudo aptitude install gnome-session
  : sudo aptitude install gnome-terminal
  : sudo aptitude install gdm3




  : sudo aptitude install aspell aspell-fr aspell-en autoconf bijiben build-essential cadaver chromium-browser cmake cmake-curses-gui conky-all cowsay debian-goodies deja-dup detox disper dosbox elinks epiphany-browser espeak firmware-linux-free flashplugin-nonfree fonts-crosextra-carlito fonts-crosextra-caladea fortune gcstar gftp gir1.2-gweather-3.0 git gkbd-capplet gnome-shell-extensions gnome-tweak-tool gnote gparted gtg gtick gtk2-engines-pixbuf gvncviewer hibernate hunspell-en-ca hunspell-en-us hunspell-fr libreoffice-gnome libreoffice-pdfimport marble most mozplugger myspell-en-gb network-manager-openconnect-gnome network-manager-vpnc-gnome ntp pandoc pandoc-citeproc privoxy python-vte revelation rsync screen stellarium subversion telepathy-haze terminator tesseract-ocr tesseract-ocr-eng tesseract-ocr-fra transmission tree ttf-mscorefonts-installer ttf-arphic-ukai ttf-arphic-uming ttf-arphic-gkai00mp ttf-arphic-gbsn00lp ttf-arphic-bkai00mp ttf-arphic-bsmi00lp ttf-kochi-gothic ttf-kochi-mincho ttf-baekmuk unetbootin unifont unison units unrar vpnc wakeonlan yafc


*** Web

- Mozilla software
  : sudo aptitude install iceweasel iceweasel-l10n-fr icedove icedove-l10n-fr iceowl-extension iceowl-l10n-fr torbrowser-launcher
- Icedove integration with Gnome calendar 
  : gsettings set org.gnome.desktop.default-applications.office.calendar exec icedove
# Créer un faux compte sous Evolution ; puis Fichier > Nouveau > Agenda ; Type : CalDAV, Nom : Agenda calDav, « Marquer comme agenda par défaut », URL : caldav://mathieu.basille.net/cloud/remote.php/caldav/calendars/mathieu/default%20calendar/ (ou mettre caldav://mathieu.basille.net/cloud/remote.php/caldav/calendars/mathieu/ et rechercher les calendriers), Rafraichir aux 15 minutes, Appliquer. Fermer Evolution...
# Intégration à Gnome :
# * Thunderbird : https://github.com/gnome-integration-team/thunderbird-gnome
# * Les deux : https://addons.mozilla.org/fr/firefox/addon/htitle/
- Suppression des liens des dicos fr_*
  : sudo rm /usr/share/hunspell/fr_*
  : sudo rm /usr/share/myspell/dicts/fr_*
  In case of trouble, just reinstal =hunspell-fr=.
- Privoxy : 
  : sudo aptitude install privoxy
  Paramètres Gnome / Réseau / Serveur mandataire : HTTP/HTTPS = localhost:8118
- Enigmail (needs version >= 1.8):
  : sudo aptitude install -t unstable enigmail
  Then change Gnome settings for the passphrase:
  : gsettings list-recursively org.gnome.crypto.cache
  Lists relevant settings: the method can be `session` (never
  expires during the session), `idle` (timer is reset each time
  there's activity on the computer) or `timeout` (simple timer since
  entering the passphrase). We set it to `timeout` with 5 minutes of
  delay: 
  : gsettings set org.gnome.crypto.cache gpg-cache-method "timeout"
  : gsettings set org.gnome.crypto.cache gpg-cache-ttl 300


*** Multimedia

  : sudo aptitude install gimp-gmic gimp-plugin-registry gimp-resynthesizer gthumb hugin imagemagick inkscape darktable rawtherapee phatch qtpfsgui cuetools easytag flac gstreamer1.0-ffmpeg gstreamer1.0-fluendo-mp3 gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly monkeys-audio shntool soundconverter devede easytag mkvtoolnix oggconvert pitivi frei0r-plugins gnome-video-effects-frei0r openshot rhythmbox-ampache sound-juicer sox subtitleeditor vlc vorbis-tools vorbisgain xbmc sweethome3d qarte chromium-bsu

# Slowmo : http://slowmovideo.granjow.net/
# Récupérer package for Ubuntu Raring
# Dépendances :
# $ sudo aptitude install build-essential cmake git ffmpeg libavformat-dev libavcodec-dev libswscale-dev libqt4-dev freeglut3-dev libglew1.5-dev libsdl1.2-dev libjpeg-dev libopencv-video-dev libopencv-highgui-dev
# (attention, conflit entre libopencv-highgui-dev qui demande libtiff4 alors que libtiff5 est installée...)
# Puis
# $ sudo dpkg -i slowmovideo_0.3.1-5~raring1_amd64.deb


*** Polices

Hack: http://sourcefoundry.org/hack/
Copy OTF files in /usr/local/share/fonts and check permissions:
$ sudo cp * /usr/local/share/fonts/
$ sudo chmod -R 777 /usr/local/share/fonts
Use gnome-tweak-tools to change non-proportional font to Hack Regular 11

Calibri/Cambria : https://wiki.debian.org/SubstitutingCalibriAndCambriaFonts
Install Carlito and Caladea, + LibreOffice font substitution (nothing checked though)


*** Emacs / LaTeX / PDF

  : sudo aptitude install emacs24 gedit-latex-plugin gummi ispell texlive-full bibtex2html rubber jabref latex2rtf xpdf pdftk pdfjam poppler-utils libtext-pdf-perl pdf2svg impressive pdfchain pdfshuffler calibre mupdf pdf2djvu scribus xournal ditaa
# (emacs emacs-goodies-el ess org-mode)
# (ocrfeeder ocrodjvu)
Note that =biblatex= lives in =texlive-bibtex-extra=, which comes with
=texlive-full=; =pdfmanipulate= comes with =calibre=.

**** Emacs

Config:

: cp -R .emacs.d ~
: xrdb -merge ~/.Xresources

- Different font between Emacs and other software (e.g. gedit): gnome-tweak-tool > Polices > Optimisation > Full
- To get Emacs in the list of available software (contextual menu):
  : nano /home/mathieu/.local/share/applications/emacs.desktop
  #+BEGIN_QUOTE
  : [Desktop Entry]
  : Version=1.0
  : Name=Emacs
  : GenericName=Text Editor
  : Comment=View and edit files
  : MimeType=text/english;text/plain;text/x-makefile;text/x-c++hdr;text/x-c++src;te$
  : Exec=/usr/bin/emacs %F
  : TryExec=emacs
  : Icon=/usr/share/icons/hicolor/scalable/apps/emacs.svg
  : Type=Application
  : Terminal=false
  : Categories=Utility;Development;TextEditor;
  #+END_QUOTE
- Install a package (e.g. =moderncv=)
  : sudo nano /etc/texmf/texmf.d/03local.cnf
  #+BEGIN_QUOTE
  : TEXMFHOME = ~/.emacs.d/texmf
  #+END_QUOTE
  : sudo update-texmf
  Check with:
  : kpsewhich --var-value TEXMFHOME
  Copy packages in =~/.emacs.d/texmf/tex/latex/= and complete install
  when necessary, e.g.:
  : latex moderntimeline.ins
  : latex moderntimeline.dtx
- Install a font: copy the font in =~/.emacs.d/texmf/fonts/truetype/=, then update the TeX index: 
  : sudo texhash


**** JabRef

- Import preferences (PrefJabRef-2014-XX-XX)
- Use =/home/mathieu/Work/biblio/PDF/= as main file folder (External
  programs)
- GTK look & feel: Options > Preferences > Advanced > Class name:
  "com.sun.java.swing.plaf.gtk.GTKLookAndFeel"
- Link folder of main BibTeX file to the Tex install:
  : mkdir ~/.texmf-var/
  : mkdir ~/.texmf-var/bibtex/
  : ln -s ~/Work/biblio/ ~/.texmf-var/bibtex/bib
  Check with:
  : kpsewhich -show-path=.bib


**** PDF

- Adobe Reader (in dmo)
  : sudo aptitude install acroread:i386


*** Other

**** Google Stuff

1) Google Earth

The Debian way:
  : sudo aptitude install googleearth-package
  : sudo dpkg --add-architecture i386
  : sudo apt-get install alien ia32-libs-gtk lib32nss-mdns libfreeimage3 lsb-core msttcorefonts pax rpm ttf-dejavu ttf-bitstream-vera
  : make-googleearth-package --force
  : sudo dpkg -i googleearth*.deb
But impossible to install =ia32-libs=... Solution: get offical .deb @ Google, then: 
  : dpkg-deb -R google-earth-stable_current_amd64.deb gg
To extract files, remove dependence to =ia32-libs= in DEBIAN/Control before recreating the archive: 
  : dpkg-deb -b gg google-earth-stable_current_amd64_mod.deb
  : sudo dpkg -i google-earth-stable_current_amd64_mod.deb

2) Google Chrome

Add Google Chrome repository (sources.list + preferences), then:

$ sudo aptitude install google-chrome-stable



**** Skype

[[http://wiki.debian.org/skype][Information]]

  : sudo dpkg --add-architecture i386
  : sudo aptitude update
  : wget -O skype-install.deb http://www.skype.com/go/getskype-linux-deb
  : sudo dpkg -i skype-install.deb
  : sudo aptitude -f install
If necessary, install dependencies manually:
  : sudo aptitude install libc6:i386 libgcc1:i386 libqt4-dbus:i386 libqt4-network:i386 libqt4-xml:i386 libqtcore4:i386 libqtgui4:i386 libqtwebkit4:i386 libstdc++6:i386 libx11-6:i386 libxext6:i386 libxss1:i386 libxv1:i386 libssl1.0.0:i386 libpulse0:i386 libasound2-plugins:i386

Don't mute sound (music) when Skype (VoIP) calls or other notifications:
  : sudo nano /etc/pulse/default.pa 
and comment the line:
  #+BEGIN_QUOTE
  : ### Cork music/video streams when a phone stream is active
  : #load-module module-role-cork
  #+END_QUOTE


**** Rockbox utility

- Download [[http://www.rockbox.org/download/][Rockbox utility]]
- Unzip file, and copy RockboxUtility in =/usr/local/bin/=:
  : tar xvjf RockboxUtility-v1.4.0-64bit.tar.bz2
  : sudo mv RockboxUtility-v1.4.0-64bit/RockboxUtility /usr/local/bin/rockbox
  : sudo chmod 755 /usr/local/bin/rockbox 
  : rm -R RockboxUtility-v1.4.0-64bit
- Launch =rockbox=
- Install Ambiance theme (activate icons).



**** ownCloud and Dropbox

sudo aptitude install owncloud-client nautilus-owncloud cadaver

(or from backports:

sudo aptitude install -t jessie-backports owncloud-client nautilus-owncloud

sudo aptitude install nautilus-dropbox
## To install deamon
dropbox start -i



**** Windows share

Credential file:

nano .smb
username=basille
password=*****
chmod 600 .smb

sudo mkdir /mnt/ecored
sudo mount.cifs //if-srv-flfile02/data/Unit/EcoRed /mnt/ecored/ -o credentials=/home/mathieu/.smb,uid=mathieu,gid=mathieu

mkdir MabLab
mkdir MabLab/bkp
mkdir MabLab/bkp/mathieu
mkdir MabLab/bkp/mathieu/home

#!/bin/sh
#################################################
##                                             ##
##  rsync home Micmac on Ecored                ##
##                                             ##
#################################################

#################################################
##                                             ##
##  -n pour tester le script sans modifs !     ##
##                                             ##
#################################################


### Mount Ecored
sudo mount.cifs //if-srv-flfile02/data/Unit/EcoRed /mnt/ecored/ -o credentials=/home/mathieu/.smb,uid=mathieu,gid=mathieu

### Save file ACLs (permission, ownership)
cd ~
getfacl -R . > .file-acl
### Restore file ACLs
# cd Bkp/
# setfacl --restore=.file-acl

### tout home sauf Photos, Musique, Vidéos, caches/thumbnails, .extraswap, emacs.d/elpa/, .R-site/site-library/, Torbrowser, Trash
###  --modify-window=1 to consider rounded timestamp 
rsync -avz --progress --delete-during --modify-window=1 --exclude=Musique --exclude=Images/Photos --exclude=Vidéos --exclude=.local/share/torbrowser --exclude=.cache --exclude=.extraswap --exclude=.gftp/cache --exclude=.googleearth/Cache/ --exclude=.thumbnails --exclude=.emacs.d/elpa --exclude=.R-site/site-library/ --exclude=.local/share/Trash /home/mathieu/ /mnt/ecored/MabLab/bkp/mathieu/home/

### Unmount Ecored
sudo umount /mnt/ecored/




# QGIS, GEOS, GDAL, PROJ.4
# $ sudo aptitude install libgdal-dev libgeos-dev gdal-bin qgis python-qgis libproj-dev proj-bin
# (qgis 2.0 time manager)

# R
# $ sudo aptitude install r-base-core r-base-dev r-recommended r-cran-rodbc r-cran-rjava r-cran-tkrplot littler jags libcairo2-dev libglu1-mesa-dev libxt-dev

# Copie des fichiers de config (.Renviron, .Rprofile, dossier .R-site)

# Package list:
# > install.packages(c("ade4", "adehabitat", "adehabitatHR", "adehabitatHS", "adehabitatLT", "adehabitatMA", "beanplot", "biomod2", "Cairo", "circular", "colorRamps", "coxme", "data.table", "devtools", "dismo", "dplyr", "foreign", "fortunes", "gam", "ggplot2", "knitcitations", "knitr", "lme4", "lubridate", "maptools", "markdown", "moments", "MuMIn", "plyr", "randomForest", "raster", "rasterVis", "RColorBrewer", "RCurl", "reshape2", "rgdal", "rgeos", "rms", "roxygen2", "RPostgreSQL", "rworldmap", "rworldxtra", "scales", "SDMTools", "sp", "spacetime", "stringr", "testthat", "trip", "XML"))

# Après installation de GDAL/GEOS/PROJ.4 :
# > install.packages(c("rgdal", "rgeos"))

# Packages perso :
# > install.packages(c("basr", "hab", "seasonality", "rpostgis"), repos = "http://ase-research.org/R/")
# Ou version de dév :
# > library(devtools)
# > install_github("basille/basr")
# > install_github("basille/hab")
# > install_github("basille/seasonality")
# > install_github("basille/rpostgis")

# * R

# $ mkdir ~/.R-site
# $ mkdir ~/.R-site/site-library
# $ cp .Renviron ~
# $ cp .Rprofile ~
# Copier le contenu de .R-site (sauf site-library)
# Packages (après installation de GEOS & GDAL)
# /!\ en 'sudo R' pour les avoir pour tous les utilisateurs...
# > install.packages("adehabitatHS", dep = TRUE)
# > install.packages(c("adehabitat", "rgdal", "raster"))
# > install.packages(c("beanplot", "Cairo", "clusterSim", "ggplot2", "MuMIn", "lme4", "rms"))

# Pour utiliser un plus haut niveau de la pile C, sous emacs : lancer un shell (M-x shell)
# $ ulimit -s 30000
# $ R
# Associer le R : M-x ess-remote RET r RET




# Virer Mono
# $ sudo aptitude purge mono-runtime cli-common mono-4.0-gac


# Francisation :
# $ sudo dpkg-reconfigure locales
# Choisir en-GB.UTF-8, en-US.UTF-8, fr-FR.UTF-8 (default), fr-CA.UTF-8
# http://forum.hardware.fr/hfr/OSAlternatifs/debian-francisation-programmes-sujet_31606_1.htm
# http://liberez-le-tux.servhome.org/blog/2011/04/22/franciser-un-systeme-debian/
# http://wiki.debian.org/Locale
# Si besoin, reconfigurer le dossier de bureau :
# $ xdg-user-dirs-update --set DESKTOP /home/user/Bureau/
# Pour vérifier :
# $ less .config/user-dirs.dirs

# Supprimer les locales inutiles
# $ sudo aptitude install localepurge
# $ sudo localepurge

# Nettoyage final
# $ upgrade


# * Terminal

# Personnalisation terminator (couleurs blanc sur noir, transparence 0.7, menu) ; terminator par défaut :
# (pas exactement ça...)
# $ sudo mv /usr/bin/gnome-terminal /usr/bin/gnome-terminal-gnome
# $ sudo ln -s /usr/bin/terminator /usr/bin/gnome-terminal
# Ouvrir un terminal dans Nautilus:
# $ sudo aptitude install nautilus-actions
# Importer le fichier Desktop suivant :
# ======  Ouvrir dans un Terminator  ===================
# [Desktop Entry]
# Type=Action
# TargetLocation=true
# ToolbarLabel[fr_FR]=Ouvrir dans un Terminator
# ToolbarLabel[fr]=Ouvrir dans un Terminator
# Name[fr_FR]=Ouvrir dans un Terminator
# Name[fr]=Ouvrir dans un Terminator
# Profiles=profile-zero;

# [X-Action-Profile profile-zero]
# MimeTypes=inode/directory;
# Exec=terminator --working-directory=%f
# Name[fr_FR]=Profil par défaut
# Name[fr]=Profil par défaut
# ======================================================
# Quelques insultes pour les erreurs de mots de passe :
# 	sudo visudo
# Rajouter, en début de fichier, la ligne : 
# 	Defaults    insults


# * Nautilus

# - Trier les dossiers avant les fichiers (l'option n'a pas d'effet) :
# $ gsettings set org.gnome.nautilus.preferences sort-directories-first true
# - Dossier des modèles :
# $ touch /home/mathieu/Modèles/Texte\ brut
# $ ln /home/mathieu/Work/templates/knitr-template.Rnw /home/mathieu/Modèles/Knitr.Rnw
# $ ln /home/mathieu/Work/templates/rmarkdown-template.Rmd /home/mathieu/Modèles/RMarkdown.Rmd


# * Système

# - Régler les applications préférées (Menu perso > Paramètres système > Informations système > Applications par défaut)
# - Date dans l'horloge : gsettings set org.gnome.desktop.interface clock-show-date true
# - Raccourcis clavier (Basculer l'état d'agrandissement : Super+Entrée ; Client de messagerie : Super+E ; Navigateur Web : Super+W ; Dossier personnel : Super+H ; Masquer toutes les fenêtres normales : Super+D ; Verrouiller l'écran : Ctrl+Échap ; Raccourcis perso : Terminator : Super+T)
# - Conserver l'activation du pavé numérique entre sessions :
# $ gsettings set org.gnome.settings-daemon.peripherals.keyboard remember-numlock-state true
# - Applications au démarrage : gnote/gtg
# (si besoin, créer le dossier : mkdir ~/.config/autostart )

# - Keyboard layout
# https://help.ubuntu.com/community/Custom%20keyboard%20layout%20definitions
#
# List of character here: /usr/include/X11/keysymdef.h
#
# French keyboard: use (and modify): 'xkb_symbols "oss_latin9"' / 'name[Group1]="French (alternative, Latin-9 only)"'
# Changes marked with '// #####'
# * AltGr + Shift + 4 pour apostrophe arrondie (’)
# * AltGr + Shift + 6 pour tiret semi-cadratin (en dash –)
# * AltGr + Shift + 8 pour tiret cadratin (em dash —)
# * AltGr + Shift + : pour points de suspension (…)
# * AltGr + Shift + ! pour cœur (♥)
# * AltGr (+ Shift) + Espace pour espace insécable
# * Shift droit pour inférieur / supérieur
# * Ctrl droit pour menu contextuel
#
# US keyboard: use (and modify): 'xkb_symbols "basic"' / 'name[Group1]= "English (US)"'
# Changes marked with '// #####'
# * AltGr (+ Shift) + Space for non-breaking space
# * Right Shift for less/greater<>
# * Right Ctrl for contextual menu
#
# $ sudo mv /usr/share/X11/xkb/symbols/fr /usr/share/X11/xkb/symbols/fr.bkp
# $ sudo cp Keyboard/fr /usr/share/X11/xkb/symbols/
# $ sudo mv /usr/share/X11/xkb/symbols/us /usr/share/X11/xkb/symbols/us.bkp
# $ sudo cp Keyboard/us /usr/share/X11/xkb/symbols/


# * Conky

# $ nano ~/.conkyrc
# ### ===================== DÉBUT ===================== ###
# use_xft yes
# xftfont 123:size=8
# xftalpha 0.1
# total_run_times 0
# own_window yes
# own_window_type desktop
# own_window_argb_visual yes
# own_window_argb_value 255
# own_window_transparent yes
# own_window_hints undecorated,below,sticky,skip_taskbar,skip_pager
# double_buffer yes
# minimum_size 250 5
# maximum_width 500
# draw_shades no
# draw_outline no
# draw_borders no
# draw_graph_borders no
# default_color white
# default_shade_color red
# default_outline_color green
# no_buffers yes
# uppercase yes
# cpu_avg_samples 2
# net_avg_samples 1
# override_utf8_locale yes
# use_spacer left 

# # Frequence de mise a jour (secondes)
# update_interval 1

# # Position en bas a droite
# alignment bottom_right

# # Decalage par rapport aux bordures
# gap_x 30
# gap_y 20

# TEXT
# ${color EAEAEA}${font GE Inspira:pixelsize=55}${alignr}${time %H:%M}${font GE Inspira:pixelsize=18}
# ${voffset 10}${alignr}${color EAEAEA}${time %A} ${color D12122}${time %d} ${color EAEAEA}${time %B}
# ${font Ubuntu:pixelsize=10}${alignr}${color D12122}HD $color${fs_bar 7,150 /home}
# ${font Ubuntu:pixelsize=10}${alignr}${color D12122}RAM $color${membar 7,150}
# ${font Ubuntu:pixelsize=10}${alignr}${color D12122}SWAP $color${swapbar 7,150}
# ${font Ubuntu:pixelsize=10}${alignr}${color D12122}CPU $color${cpubar cpu1 7,36} $color${cpubar cpu2 7,35} $color${cpubar cpu3 7,35} $color${cpubar cpu4 7,35}
# ### ====================== FIN ====================== ###
# Puis :
# $ nano ~/.config/autostart/conky.desktop
# [Desktop Entry]
# Type=Application
# Exec=conky
# Hidden=false
# X-GNOME-Autostart-enabled=true
# Name=Conky
# (pour relancer Conky :  killall -SIGUSR1 conky)


# * Extensions Gnome

# - Liste : https://extensions.gnome.org/local/
# o Applications Menu
# o Auto Move Windows
# o Calculator
# x Connection Manager
# x Launch new instance
# o Media player indicator
# x Native Window Placement
# o OpenWeather
# o Panel World Clock
# o Places Status Indicator
# o Quick Close in Overview
# x Removable Drive Menu
# o Skype Integration
# o Suspend Button
# x SystemMonitor
# x TopIcons
# x User Themes
# x Window List
# o windowNavigator
# x Workspace Indicator
# - Not working for Gnome Shell 3.12
# o Candy Thief
# o Window options
# o WindowOverlay Icons
# o Workspace Navigator
# o workspaceAltTab


# * gFTP, Gnote, GTG

# Copier les contenus des dossiers .gftp, .local/share/gnote et .local/share/gtg
# Applications au démarrage : GTG (regarder dans les options) ; Gnotes :
# $ nano ~/.config/autostart/gnote.desktop
# [Desktop Entry]
# Type=Application
# Exec=/usr/bin/gnote %u
# Hidden=false
# X-GNOME-Autostart-enabled=true
# Name=Gnote
# Comment[fr_FR.UTF-8]=Prendre des notes, relier des idées, rester organisé


# * VPNC + SSH

# Fichiers *.conf dans ~/.vpnc
# En ligne de commande
# # cp .vpnc/* /etc/vpnc/
# # cd /etc/vpnc/
# # ls -l
# Ligne à vérifier pour ne passer que les .conf en 600
# # chmod 600 *.conf
# Sinon via network-manager, en installant network-manager-vpnc network-manager-vpnc-gnome

# Copier .ssh/config
# $ mkdir ~/.ssh
# $ cp .ssh/config ~/.ssh/

# Copier répertoire de scripts et unison :
# $ cp -R .scripts ~
# $ cp -R .unison ~
# $ mkdir ~/.unison/bkp




# Ajouter un logiciel dans la liste Ouvrir avec...
# - First look for the program (.desktop) in /usr/share/applications.
# - Edit the program file so that the Exec line looks like:
# Exec=yourprogram %U
# - Now the program should show up in application list 


# Fichiers RAW

# ## DCRAW 9.16 (version courante)
# sudo aptitude install libjasper-dev libjpeg8-dev liblcms1-dev liblcms2-dev
# sudo ldconfig
# mkdir dcraw
# cd dcraw
# wget http://www.cybercom.net/~dcoffin/dcraw/dcraw.c
# gcc -o dcraw -O4 dcraw.c -lm -ljasper -ljpeg -llcms
# sudo mv dcraw /usr/bin
# cd ..
# rm -R dcraw

# ## Vignettes
# sudo aptitude install ufraw ufraw-batch gimp-dcraw
# sudo nano /usr/share/thumbnailers/raw.thumbnailer
# Plus nécessaire :
# $ sudo aptitude install libopenrawgnome1


# [Thumbnailer Entry]
# Exec=/usr/bin/ufraw-batch --embedded-image --out-type=png --size=%s %u --overwrite --silent --output=%o
# MimeType=image/x-3fr;image/x-adobe-dng;image/x-arw;image/x-bay;image/x-canon-cr2;image/x-canon-crw;image/x-cap;image/x-cr2;image/x-crw;image/x-dcr;image/x-dcraw;image/x-dcs;image/x-dng;image/x-drf;image/x-eip;image/x-erf;image/x-fff;image/x-fuji-raf;image/x-iiq;image/x-k25;image/x-kdc;image/x-mef;image/x-minolta-mrw;image/x-mos;image/x-mrw;image/x-nef;image/x-nikon-nef;image/x-nrw;image/x-olympus-orf;image/x-orf;image/x-panasonic-raw;image /x-pef;image/x-pentax-pef;image/x-ptx;image/x-pxn;image/x-r3d;image/x-raf;image/x-raw;image/x-rw2;image/x-rwl;image/x-rwz;image/x-sigma-x3f;image/x-sony-arw;image/x-sony-sr2;image/x-sony-srf;image/x-sr2;image/x-srf;image/x-x3f;



# ### To do :

# ### Lieux (Québec, Lyon, Trondheim) --> météo OK, mais pas différents lieux :(

# ### sudo

# ### Clés SSH et GPG

# ### RSync
# > Copier RSync dans .scripts/RSync
# > Raccourci bureau vers les 2 avec les icones dans .scripts/Icones

     # ### GCStar
